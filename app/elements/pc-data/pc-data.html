<dom-module id="pc-data">

  <template>
      <span id="idFirebase">
          </span> 
    <!--<firebase-collection location="{{userLocation}}"
                         data="{{data}}"
                         on-firebase-value="_firebaseLoaded">
    </firebase-collection>-->
  </template>
  <script>  
    Polymer({
      is: 'pc-data',
      properties: {
        data: {
          notify: true,
          value: []
        },
        user: {
          observer: '_userChanged'
        },
        location: {
          value: 'https://polycafe.firebaseio.com'
        },
        table: {},
        useMock: { value: false }
      },
      _userChanged: function(user) {
        if (user) {
          if(this.useMock)
          {
            this.userLocation = ['../../data/', this.table, '-data.json'].join('');
          }
          else
          {
            this.userLocation = [this.location, 'users', this.user.uid, this.table].join('/');
            
            var fb = document.createElement('firebase-collection');
            fb.setAttribute('location', this.userLocation);
            fb.setAttribute('data', this.data);  
            fb.setAttribute('on-firebase-value', this._firebaseLoaded);
            //document.querySelector('#idFirebase').appendChild(fb);
            this.$.idFirebase.appendChild(fb);
          }
        } 
      },
      _firebaseLoaded: function() {
        console.log('firebase control data !');
        console.log(this.data);
      }
    }); 
  </script>
</dom-module>


      <!--_cityUpdated: function(val) {
        var vals = [];
        _.forEach(val, function(v) { 
          vals.push(v); 
        });
        
        var res = JSON.stringify(vals);
        localStorage.setItem('dropdown.city', res);   
      }-->